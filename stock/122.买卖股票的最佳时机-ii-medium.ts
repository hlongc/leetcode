/*
 * @lc app=leetcode.cn id=122 lang=typescript
 *
 * [122] 买卖股票的最佳时机 II
 *
 * https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-ii/description/
 *
 * algorithms
 * Medium (75.40%)
 * Likes:    2798
 * Dislikes: 0
 * Total Accepted:    1.4M
 * Total Submissions: 1.9M
 * Testcase Example:  '[7,1,5,3,6,4]'
 *
 * 给你一个整数数组 prices ，其中 prices[i] 表示某支股票第 i 天的价格。
 *
 * 在每一天，你可以决定是否购买和/或出售股票。你在任何时候 最多 只能持有 一股 股票。然而，你可以在 同一天
 * 多次买卖该股票，但要确保你持有的股票不超过一股。
 *
 * 返回 你能获得的 最大 利润 。
 *
 *
 *
 * 示例 1：
 *
 *
 * 输入：prices = [7,1,5,3,6,4]
 * 输出：7
 * 解释：在第 2 天（股票价格 = 1）的时候买入，在第 3 天（股票价格 = 5）的时候卖出, 这笔交易所能获得利润 = 5 - 1 = 4。
 * 随后，在第 4 天（股票价格 = 3）的时候买入，在第 5 天（股票价格 = 6）的时候卖出, 这笔交易所能获得利润 = 6 - 3 = 3。
 * 最大总利润为 4 + 3 = 7 。
 *
 * 示例 2：
 *
 *
 * 输入：prices = [1,2,3,4,5]
 * 输出：4
 * 解释：在第 1 天（股票价格 = 1）的时候买入，在第 5 天 （股票价格 = 5）的时候卖出, 这笔交易所能获得利润 = 5 - 1 = 4。
 * 最大总利润为 4 。
 *
 * 示例 3：
 *
 *
 * 输入：prices = [7,6,4,3,1]
 * 输出：0
 * 解释：在这种情况下, 交易无法获得正利润，所以不参与交易可以获得最大利润，最大利润为 0。
 *
 *
 *
 * 提示：
 *
 *
 * 1 <= prices.length <= 3 * 10^4
 * 0 <= prices[i] <= 10^4
 *
 *
 */

// @lc code=start
/**
 * 解法：贪心算法
 *
 * 核心思想：
 * - 由于可以无限次交易且没有手续费，我们可以抓住每一次上涨的机会
 * - 只要第二天价格比今天高，就可以今天买入、明天卖出获利
 * - 将所有上涨的利润累加起来，就是最大利润
 *
 * 关键洞察：
 * - 多次小交易的利润总和 = 一次大交易的利润
 *   例如：prices[0]=1, prices[2]=5
 *   方案1：第0天买入，第2天卖出，利润 = 5-1 = 4
 *   方案2：第0天买入第1天卖出(利润a)，第1天买入第2天卖出(利润b)
 *         总利润 = a + b = (prices[1]-1) + (5-prices[1]) = 5-1 = 4
 * - 因此，我们只需要累加所有相邻上涨的差值即可
 *
 * 算法流程：
 * 1. 遍历价格数组
 * 2. 如果今天价格 > 昨天价格，累加差值（相当于昨天买入今天卖出）
 * 3. 如果今天价格 <= 昨天价格，不操作（下跌不交易）
 *
 * 示例演示 [7,1,5,3,6,4]：
 * Day 0→1: 1<7，下跌，不交易，利润=0
 * Day 1→2: 5>1，上涨，交易，利润=4 (累计4)
 * Day 2→3: 3<5，下跌，不交易，利润=4
 * Day 3→4: 6>3，上涨，交易，利润=3 (累计7)
 * Day 4→5: 4<6，下跌，不交易，利润=7
 * 最终结果：7
 *
 * 时间复杂度：O(n)，遍历数组一次
 * 空间复杂度：O(1)，只使用常数个额外变量
 */
function maxProfit(prices: number[]): number {
  // 边界处理：少于2天无法完成交易
  if (prices.length <= 1) {
    return 0;
  }

  // 总利润，初始化为0
  let totalProfit = 0;

  // 从第二天开始遍历
  for (let i = 1; i < prices.length; i++) {
    // 计算今天相对于昨天的价格变化
    const priceDiff = prices[i] - prices[i - 1];

    // 贪心策略：只要今天价格比昨天高，就进行交易
    // 相当于昨天买入，今天卖出
    if (priceDiff > 0) {
      totalProfit += priceDiff;
    }
    // 如果价格下跌或持平（priceDiff <= 0），不进行任何操作
  }

  return totalProfit;
}
// @lc code=end
