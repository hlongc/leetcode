# é—®é¢˜26ï¼šåœ¨ä¸å¼€å¯æ ·å¼éš”ç¦»çš„æƒ…å†µä¸‹ï¼Œqiankun å¦‚ä½•é˜²æ­¢å­åº”ç”¨çš„æ ·å¼æ±¡æŸ“ï¼Ÿ

## ğŸ“Œ æ ¸å¿ƒç­–ç•¥

å³ä½¿ä¸å¼€å¯ qiankun çš„æ ·å¼éš”ç¦»åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹ç­–ç•¥é˜²æ­¢æ ·å¼æ±¡æŸ“ï¼š

1. **CSS Modules**
2. **CSS-in-JS**
3. **BEM å‘½åè§„èŒƒ**
4. **åº”ç”¨å‰ç¼€**
5. **æ ·å¼ä½œç”¨åŸŸé™åˆ¶**
6. **åŠ¨æ€æ ·å¼å¸è½½**

## ğŸ¯ 1. CSS Modulesï¼ˆæœ€æ¨èï¼‰

### åŸç†

CSS Modules ä¼šä¸ºæ¯ä¸ªç±»åç”Ÿæˆå”¯ä¸€çš„å“ˆå¸Œå€¼ã€‚

```javascript
// App.module.css
.title {
    color: red;
}

.button {
    background: blue;
}
```

**ç¼–è¯‘åï¼š**

```css
/* ç”Ÿæˆå”¯ä¸€çš„ç±»å */
.title_a1b2c3 {
    color: red;
}

.button_d4e5f6 {
    background: blue;
}
```

**ä½¿ç”¨ï¼š**

```javascript
import styles from './App.module.css';

function App() {
    return (
        <div>
            <h1 className={styles.title}>æ ‡é¢˜</h1>
            <button className={styles.button}>æŒ‰é’®</button>
        </div>
    );
}

// æ¸²æŸ“åï¼š
// <h1 class="title_a1b2c3">æ ‡é¢˜</h1>
// <button class="button_d4e5f6">æŒ‰é’®</button>
```

**éš”ç¦»æ•ˆæœï¼š**

```css
/* ä¸»åº”ç”¨ */
.title_x1y2z3 { color: blue; }

/* å­åº”ç”¨A */
.title_a1b2c3 { color: red; }

/* å­åº”ç”¨B */
.title_m7n8o9 { color: green; }

/* ä¸‰ä¸ªç±»åå®Œå…¨ä¸åŒï¼Œä¸ä¼šå†²çª âœ“ */
```

**é…ç½®ï¼ˆwebpackï¼‰ï¼š**

```javascript
module.exports = {
    module: {
        rules: [
            {
                test: /\.css$/,
                use: [
                    'style-loader',
                    {
                        loader: 'css-loader',
                        options: {
                            modules: {
                                localIdentName: '[name]__[local]__[hash:base64:5]'
                            }
                        }
                    }
                ]
            }
        ]
    }
};
```

## ğŸ’… 2. CSS-in-JS

### styled-components

```javascript
import styled from 'styled-components';

// å®šä¹‰æ ·å¼ç»„ä»¶
const Title = styled.h1`
    color: red;
    font-size: 24px;
`;

const Button = styled.button`
    background: blue;
    padding: 10px;
`;

function App() {
    return (
        <div>
            <Title>æ ‡é¢˜</Title>
            <Button>æŒ‰é’®</Button>
        </div>
    );
}
```

**ç”Ÿæˆçš„ä»£ç ï¼š**

```html
<style>
    .sc-bdvvaa { color: red; font-size: 24px; }
    .sc-gKclnd { background: blue; padding: 10px; }
</style>

<h1 class="sc-bdvvaa">æ ‡é¢˜</h1>
<button class="sc-gKclnd">æŒ‰é’®</button>
```

**ç‰¹ç‚¹ï¼š**
- è‡ªåŠ¨ç”Ÿæˆå”¯ä¸€ç±»å
- æ ·å¼ä¸ç»„ä»¶ç»‘å®š
- ä¸ä¼šæ±¡æŸ“å…¨å±€
- æ”¯æŒä¸»é¢˜ã€åŠ¨æ€æ ·å¼

### emotion

```javascript
/** @jsxImportSource @emotion/react */
import { css } from '@emotion/react';

const titleStyle = css`
    color: red;
    font-size: 24px;
`;

function App() {
    return <h1 css={titleStyle}>æ ‡é¢˜</h1>;
}
```

## ğŸ“ 3. BEM å‘½åè§„èŒƒ

### BEM è§„èŒƒ

**Block__Element--Modifier**

```css
/* Blockï¼ˆå—ï¼‰ */
.user-card { }

/* Elementï¼ˆå…ƒç´ ï¼‰ */
.user-card__avatar { }
.user-card__name { }
.user-card__bio { }

/* Modifierï¼ˆä¿®é¥°ç¬¦ï¼‰ */
.user-card--featured { }
.user-card__avatar--large { }
```

### åº”ç”¨åˆ°å¾®å‰ç«¯

```css
/* ä¸»åº”ç”¨ */
.main-app-header { }
.main-app-header__logo { }
.main-app-header__nav { }

/* å­åº”ç”¨A */
.react-app-header { }
.react-app-header__title { }
.react-app-header__menu { }

/* å­åº”ç”¨B */
.vue-app-header { }
.vue-app-header__title { }
.vue-app-header__menu { }

/* é€šè¿‡åº”ç”¨å‰ç¼€ï¼Œé¿å…å†²çª âœ“ */
```

## ğŸ·ï¸ 4. ç»Ÿä¸€çš„åº”ç”¨å‰ç¼€

### ç­–ç•¥

æ¯ä¸ªåº”ç”¨çš„æ‰€æœ‰æ ·å¼éƒ½åŠ ä¸Šåº”ç”¨å‰ç¼€ã€‚

```javascript
// PostCSS æ’ä»¶è‡ªåŠ¨æ·»åŠ å‰ç¼€
// postcss.config.js

module.exports = {
    plugins: [
        require('postcss-prefix-selector')({
            prefix: '[data-app="react-app"]',  // è‡ªåŠ¨æ·»åŠ å‰ç¼€
            transform: function (prefix, selector, prefixedSelector) {
                // æ’é™¤æŸäº›é€‰æ‹©å™¨
                if (selector === 'body' || selector === 'html') {
                    return selector;
                }
                return prefixedSelector;
            }
        })
    ]
};
```

**æ•ˆæœï¼š**

```css
/* åŸå§‹ CSS */
.title { color: red; }
.content { padding: 10px; }

/* è‡ªåŠ¨æ·»åŠ å‰ç¼€å */
[data-app="react-app"] .title { color: red; }
[data-app="react-app"] .content { padding: 10px; }
```

**å®¹å™¨æ ‡è®°ï¼š**

```html
<div id="subapp-container" data-app="react-app">
    <div class="title">æ ‡é¢˜</div>
    <div class="content">å†…å®¹</div>
</div>
```

## ğŸ”’ 5. æ ·å¼ä½œç”¨åŸŸé™åˆ¶

### ç­–ç•¥ï¼šæ‰€æœ‰æ ·å¼åµŒå¥—åœ¨å®¹å™¨é€‰æ‹©å™¨ä¸‹

```scss
// ä½¿ç”¨ SCSS/LESS çš„åµŒå¥—

// å®šä¹‰åº”ç”¨æ ¹é€‰æ‹©å™¨
#react-app-root {
    // æ‰€æœ‰æ ·å¼éƒ½åœ¨è¿™ä¸ªä½œç”¨åŸŸå†…
    
    .title {
        color: red;
    }
    
    .button {
        background: blue;
    }
    
    .content {
        .item {
            padding: 10px;
        }
    }
}
```

**ç¼–è¯‘åï¼š**

```css
#react-app-root .title { color: red; }
#react-app-root .button { background: blue; }
#react-app-root .content .item { padding: 10px; }
```

**HTML ç»“æ„ï¼š**

```html
<div id="react-app-root">
    <h1 class="title">æ ‡é¢˜</h1>
    <button class="button">æŒ‰é’®</button>
</div>
```

## ğŸ—‘ï¸ 6. åŠ¨æ€æ ·å¼å¸è½½

### ç­–ç•¥ï¼šå­åº”ç”¨å¸è½½æ—¶ç§»é™¤æ ·å¼

```javascript
// è®°å½•å­åº”ç”¨æ’å…¥çš„æ ·å¼
const appStyles = [];

// åŠ«æŒæ ·å¼æ’å…¥
const originalAppendChild = HTMLHeadElement.prototype.appendChild;

HTMLHeadElement.prototype.appendChild = function(element) {
    if (element.tagName === 'STYLE' || element.tagName === 'LINK') {
        // æ ‡è®°æ ·å¼å±äºå“ªä¸ªåº”ç”¨
        element.setAttribute('data-app-style', currentAppName);
        appStyles.push(element);
    }
    
    return originalAppendChild.call(this, element);
};

// å¸è½½æ—¶æ¸…ç†
export async function unmount() {
    // ç§»é™¤æ‰€æœ‰æ ·å¼
    appStyles.forEach(style => {
        style.remove();
    });
    appStyles.length = 0;
    
    // å¸è½½ React
    ReactDOM.unmountComponentAtNode(container);
}
```

## ğŸ¨ 7. ç»„åˆç­–ç•¥ï¼ˆæ¨èï¼‰

```javascript
// æœ€ä½³å®è·µï¼šå¤šç§ç­–ç•¥ç»„åˆ

// 1. ä¸»è¦æ ·å¼ï¼šCSS Modules
import styles from './App.module.css';

// 2. å…¨å±€æ ·å¼ï¼šæ·»åŠ å‰ç¼€
.react-app-global-reset {
    margin: 0;
    padding: 0;
}

// 3. ç¬¬ä¸‰æ–¹åº“ï¼šé™åˆ¶ä½œç”¨åŸŸ
#react-app-root {
    // Ant Design ç»„ä»¶æ ·å¼åªåœ¨è¿™ä¸ªä½œç”¨åŸŸç”Ÿæ•ˆ
    @import '~antd/dist/antd.css';
}

// 4. å¸è½½æ—¶æ¸…ç†
export async function unmount() {
    // ç§»é™¤åŠ¨æ€æ’å…¥çš„æ ·å¼
    document.querySelectorAll('[data-app-style="react-app"]')
        .forEach(style => style.remove());
}
```

## ğŸ“ é¢è¯•è¦ç‚¹

### å…­å¤§ç­–ç•¥

1. **CSS Modules**ï¼šè‡ªåŠ¨ç”Ÿæˆå”¯ä¸€ç±»å
2. **CSS-in-JS**ï¼šæ ·å¼ä¸ç»„ä»¶ç»‘å®š
3. **BEM è§„èŒƒ**ï¼šå‘½åè§„èŒƒé¿å…å†²çª
4. **åº”ç”¨å‰ç¼€**ï¼šç»Ÿä¸€æ·»åŠ å‰ç¼€
5. **ä½œç”¨åŸŸé™åˆ¶**ï¼šåµŒå¥—åœ¨å®¹å™¨ä¸‹
6. **åŠ¨æ€å¸è½½**ï¼šå¸è½½æ—¶æ¸…ç†æ ·å¼

### æ¨èç»„åˆ

1. **CSS Modules + åŠ¨æ€å¸è½½**ï¼ˆæœ€æ¨èï¼‰
2. **CSS-in-JS**ï¼ˆReact åº”ç”¨ï¼‰
3. **BEM + å‰ç¼€**ï¼ˆä¼ ç»Ÿé¡¹ç›®ï¼‰
4. **ä½œç”¨åŸŸé™åˆ¶ + åŠ¨æ€å¸è½½**ï¼ˆSCSS/LESS é¡¹ç›®ï¼‰

### ä¸ qiankun éš”ç¦»çš„å…³ç³»

1. **äº’è¡¥è€Œéæ›¿ä»£**ï¼šå¯ä»¥åŒæ—¶ä½¿ç”¨
2. **å¤šå±‚é˜²æŠ¤**ï¼šqiankun éš”ç¦» + è‡ªèº«è§„èŒƒ
3. **é™ä½ä¾èµ–**ï¼šä¸å®Œå…¨ä¾èµ– qiankun

å³ä½¿ä¸å¼€å¯ qiankun çš„æ ·å¼éš”ç¦»ï¼Œé€šè¿‡å·¥ç¨‹åŒ–æ‰‹æ®µå’Œè§„èŒƒçº¦æŸï¼Œä¹Ÿèƒ½æœ‰æ•ˆé˜²æ­¢æ ·å¼æ±¡æŸ“ï¼

