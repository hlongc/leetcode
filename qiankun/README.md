# 🎯 Qiankun & Import-HTML-Entry 面试准备资料

> 基于源码分析的30道深度面试题，助您通过资深前端开发工程师面试

## 📚 文档概览

本资料库包含 **50+ 道精心设计的面试题**，分为两大部分：

### 📖 第一部分：原理深度解析（30题）
全部基于 qiankun 和 import-html-entry 的源码分析，每道题都有详细的原理讲解、代码示例和实战场景。

### 🔥 第二部分：项目实战问题（20题）
基于真实项目经验，涵盖开发、部署、优化等各个环节的实际问题和解决方案。

### 📊 内容统计

- **总文档数**：33 个
  - 30 个原理问题（独立文件）
  - 1 个实战问题合集（20题在一个文件中）
  - 1 个总目录
  - 1 个 README
- **总文档大小**：约 900KB
- **总题目数**：50+ 题
- **代码示例**：600+ 个
- **实际场景**：300+ 个
- **源码引用**：300+ 处

## 🗂️ 文档结构

### 📂 第一部分：import-html-entry 核心原理（1-8题）

微前端的基础设施，HTML 入口解析的核心库。

- `01-import-html-entry的核心作用.md` - 7大核心功能详解
- `02-processTpl函数的实现原理.md` - 正则驱动的四步解析
- `03-外链和内联脚本的处理机制.md` - 脚本加载执行完整流程
- `04-execScripts函数的执行机制.md` - 递归调度与沙箱隔离
- `05-CSS资源的处理策略.md` - 外链转内联优化策略
- `06-importEntry返回的数据结构.md` - 5个返回字段详解
- `07-缓存机制的实现.md` - 三层缓存结构
- `08-自定义fetch的作用.md` - 7大实际应用场景

**核心要点：**
- HTML Entry 模式的实现原理
- 资源解析、加载、执行的完整流程
- 缓存机制与性能优化
- 自定义 fetch 处理跨域和认证

---

### 📂 第二部分：qiankun 应用加载与生命周期（9-15题）

应用注册、路由管理、生命周期控制。

- `09-qiankun应用注册流程.md` - registerMicroApps 详解
- `10-start函数与路由劫持.md` - single-spa 路由机制
- `11-loadMicroApp与registerMicroApps的区别.md` - 两种加载方式对比
- `12-生命周期钩子详解.md` - 5个主应用钩子
- `13-子应用生命周期的调用机制.md` - bootstrap/mount/unmount
- `14-预加载机制详解.md` - 5种预加载策略
- `15-错误处理机制.md` - 4层错误处理

**核心要点：**
- 应用注册与启动流程
- 路由驱动 vs 手动加载
- 主应用与子应用的生命周期
- 预加载策略与错误处理

---

### 📂 第三部分：JavaScript 沙箱机制（16-22题）⭐ 重点

qiankun 最核心的技术，JavaScript 隔离的实现。

- `16-为什么需要JavaScript沙箱.md` - 5个核心问题场景
- `17-qiankun的三种沙箱实现.md` - 三代沙箱演进
- `18-SnapshotSandbox实现原理.md` - 快照沙箱详解
- `19-LegacySandbox实现原理.md` - 单例代理沙箱
- `20-ProxySandbox实现原理.md` - 多例代理沙箱
- `21-Proxy的trap处理机制.md` - 7个 Proxy traps 详解
- `22-不能被沙箱代理的全局属性.md` - 特殊属性处理

**核心要点：**
- 沙箱的必要性与核心价值
- 三种沙箱的实现原理与对比
- Proxy 的完整 trap 处理机制
- 特殊属性的处理策略

---

### 📂 第四部分：样式隔离方案（23-26题）

CSS 隔离的两种方案及最佳实践。

- `23-样式隔离方案概述.md` - 三种方案对比
- `24-strictStyleIsolation的Shadow-DOM实现.md` - Shadow DOM 原理
- `25-experimentalStyleIsolation的实现原理.md` - Scoped CSS 实现
- `26-不开启样式隔离时的防污染策略.md` - 6大工程化策略

**核心要点：**
- Shadow DOM vs Scoped CSS
- 样式隔离的实现原理
- 弹窗和全局样式的处理
- CSS Modules、BEM 等工程化方案

---

### 📂 第五部分：性能优化与工程实践（27-30题）

生产环境的性能优化与最佳实践。

- `27-资源预加载实现详解.md` - 智能预加载策略
- `28-首屏加载优化最佳实践.md` - 7个优化维度
- `29-应用间通信机制.md` - 5种通信方式
- `30-生产环境注意事项.md` - 生产检查清单

**核心要点：**
- requestIdleCallback 在预加载中的应用
- 首屏性能优化的完整方案
- 应用间通信的多种实现
- 生产环境的安全、监控、兼容性

---

### 📂 第六部分：项目实战问题（20题合集）⭐ 必看

`实战问题20题.md` - **一个文件包含21个实战问题及详细解答**

**问题分类：**

1. **依赖管理**（问题1, 4, 20, 38）
   - 如何共享 React/Vue 依赖
   - 不同版本框架的兼容性
   - 避免重复打包
   - axios 拦截器问题

2. **开发调试**（问题2, 6, 25, 30）
   - 子应用独立运行
   - 本地开发环境配置
   - 懒加载组件调试
   - 热更新配置

3. **配置问题**（问题3, 5, 10, 12, 19）
   - publicPath 配置
   - 路由模式选择
   - 环境变量处理
   - 打包文件名策略
   - 接口请求配置

4. **权限控制**（问题16, 34）
   - 应用级权限
   - 按钮级权限

5. **样式处理**（问题11, 26, 37）
   - 样式冲突解决
   - UI库冲突
   - CSS-in-JS 问题

6. **性能优化**（问题13, 28）
   - 按需加载
   - 性能瓶颈定位

7. **部署运维**（问题18, 21, 31）
   - Nginx 配置
   - 灰度发布
   - 版本回滚

8. **监控测试**（问题17, 22）
   - 性能监控
   - 单元测试

9. **其他实战**（问题7, 8, 9, 14, 15, 23, 24, 27, 29, 32, 33, 35, 36, 39, 40）
   - 数据共享
   - 内存泄漏排查
   - 路由同步
   - 静态资源处理
   - 版本兼容性
   - 容错处理
   - 国际化
   - Vite 集成
   - 第三方 SDK
   - SSR 方案
   - Module Federation
   - 概念区分

**核心要点：**
- 基于真实项目经验
- 涵盖开发、测试、部署全流程
- 提供完整的解决方案
- 每个问题都有代码示例

---

## 🎯 如何使用本资料

### 📖 学习路径

**第1周：基础理解（1-8题）**
- 理解 import-html-entry 的工作原理
- 掌握资源解析和加载流程
- 理解缓存机制

**第2周：核心机制（9-15题）**
- 掌握应用注册和生命周期
- 理解路由管理机制
- 掌握错误处理

**第3周：沙箱深入（16-22题）⭐ 重点**
- 理解沙箱的必要性
- 掌握三种沙箱的实现原理
- 深入 Proxy 机制

**第4周：样式与优化（23-30题）**
- 掌握样式隔离方案
- 理解性能优化策略
- 掌握生产环境实践

**第5周：实战问题（实战20题）⭐ 必看**
- 解决实际开发中的问题
- 掌握配置和调试技巧
- 学习部署和运维经验
- 准备面试中的实战问答

### 💡 面试准备建议

1. **结合源码**：每个答案都标注了源码位置，建议对照源码阅读
2. **动手实践**：尝试实现简化版的功能，加深理解
3. **场景思考**：思考每个技术点在实际项目中的应用
4. **对比总结**：对比不同实现方案的优劣

### 🎤 面试重点

#### 必问题目（⭐⭐⭐）
- 问题1: import-html-entry 的作用
- 问题4: execScripts 执行机制
- 问题9: 应用注册流程
- 问题12: 生命周期
- 问题16: 为什么需要沙箱
- 问题17: 三种沙箱实现
- 问题20: ProxySandbox 原理
- 问题23: 样式隔离方案

#### 常问题目（⭐⭐）
- 问题2: processTpl 解析
- 问题7: 缓存机制
- 问题10: 路由劫持
- 问题11: 两种加载方式对比
- 问题21: Proxy traps
- 问题28: 性能优化

#### 加分题目（⭐）
- 问题8: 自定义 fetch
- 问题14: 预加载
- 问题22: 特殊属性处理
- 问题29: 应用间通信
- 问题30: 生产环境

---

## 🔑 核心技术要点

### import-html-entry 核心

```
HTML 解析 → 资源提取 → 并行下载 → 顺序执行
    ↓           ↓           ↓          ↓
processTpl  scripts/   getExternal  execScripts
           styles     Scripts/Styles
```

### qiankun 核心

```
应用注册 → 路由匹配 → 创建沙箱 → 加载资源 → 执行脚本 → 挂载应用
    ↓          ↓          ↓         ↓         ↓         ↓
register   single-spa  Sandbox   importEntry execScripts  mount
MicroApps             (Proxy)
```

### 沙箱演进

```
SnapshotSandbox → LegacySandbox → ProxySandbox → StandardSandbox
   (兼容性)        (性能优化)     (完全隔离)      (架构重构)
    快照对比        Proxy+记录    独立fakeWindow   Membrane+
                                                 Compartment
```

### 样式隔离

```
strictStyleIsolation     experimentalStyleIsolation     不隔离
    (Shadow DOM)              (Scoped CSS)           (工程化方案)
      完全隔离                  部分隔离                  无隔离
    兼容性问题                  推荐方案                CSS Modules
```

---

## 📈 文档特色

### ✅ 基于真实源码
每个答案都引用了实际的源码片段，包含文件路径和行号，可追溯。

### ✅ 场景驱动
通过实际问题场景说明"为什么这样设计"，而不仅仅是"怎么实现"。

### ✅ 对比分析
展示错误做法 vs 正确做法，帮助深入理解设计决策。

### ✅ 完整代码
提供完整可运行的代码示例，不是片段。

### ✅ 面试要点
每篇都有重点总结，快速回顾核心内容。

---

## 🎓 面试常见问题类型

### 原理类
- "qiankun 的沙箱是如何实现的？"
- "import-html-entry 如何解析 HTML？"
- "为什么需要微前端的样式隔离？"

### 对比类
- "SnapshotSandbox 和 ProxySandbox 有什么区别？"
- "loadMicroApp 和 registerMicroApps 的区别？"
- "Shadow DOM 和 Scoped CSS 哪个更好？"

### 场景类
- "如何解决子应用的跨域问题？"
- "应用间如何通信？"
- "如何优化首屏加载速度？"

### 实战类
- "生产环境需要注意什么？"
- "遇到样式冲突怎么办？"
- "应用加载失败如何处理？"

---

## 💪 掌握程度自测

### 基础级别（能回答 1-15 题）
- ✅ 理解 import-html-entry 的作用
- ✅ 了解 qiankun 的基本用法
- ✅ 知道生命周期的概念

### 进阶级别（能回答 16-24 题）
- ✅ 理解沙箱的实现原理
- ✅ 掌握 Proxy 的使用
- ✅ 理解样式隔离方案

### 高级级别（能回答 25-30 题）
- ✅ 掌握性能优化技巧
- ✅ 了解生产环境实践
- ✅ 能够设计通信方案

### 专家级别（全部30题）
- ✅ 深入理解底层原理
- ✅ 能够优化和扩展
- ✅ 具备架构设计能力

---

## 🚀 快速开始

```bash
# 进入面试准备目录
cd interview-preparation

# 查看所有问题
ls -lh *.md

# 按顺序学习
# 1-8: import-html-entry
# 9-15: 应用管理
# 16-22: 沙箱机制（重点）
# 23-26: 样式隔离
# 27-30: 性能优化
```

---

## 📖 推荐阅读顺序

### 方案A：按模块学习
1. import-html-entry 模块（1-8）
2. qiankun 核心模块（9-15）
3. 沙箱模块（16-22）
4. 样式模块（23-26）
5. 优化模块（27-30）

### 方案B：按重要性学习
1. 高频必问题（1, 4, 9, 12, 16, 17, 20, 23）
2. 原理深入题（2, 18, 19, 21, 24, 25）
3. 实战应用题（8, 11, 28, 29, 30）
4. 补充完善题（其余题目）

### 方案C：按难度学习
1. 入门级（1, 9, 12, 23）
2. 进阶级（2, 3, 10, 11, 13）
3. 高级级（4, 16, 17, 18, 19, 20）
4. 专家级（21, 22, 25, 28, 30）

---

## 🎯 面试技巧

### 回答结构

1. **是什么**：概念定义
2. **为什么**：解决什么问题
3. **怎么做**：实现原理
4. **有什么**：优缺点、适用场景
5. **怎么用**：实际应用示例

### 示例回答

**问题：qiankun 的沙箱是如何实现的？**

**回答：**
1. **是什么**：qiankun 提供了三种沙箱实现...
2. **为什么**：为了隔离全局变量，防止应用间相互污染...
3. **怎么做**：ProxySandbox 通过创建独立的 fakeWindow 对象...
4. **有什么**：优点是完全隔离，缺点是需要 Proxy 支持...
5. **怎么用**：在实际项目中，我们使用 ProxySandbox...

### 加分项

- 提到源码细节
- 举实际项目的例子
- 说出遇到的坑和解决方案
- 对比不同方案的优劣
- 提出改进建议

---

## 📝 知识图谱

```
qiankun 微前端框架
│
├─ 核心依赖
│  └─ import-html-entry
│     ├─ HTML 解析（processTpl）
│     ├─ 资源加载（getExternalScripts/Styles）
│     ├─ 脚本执行（execScripts）
│     └─ 缓存机制
│
├─ 应用管理
│  ├─ 应用注册（registerMicroApps）
│  ├─ 手动加载（loadMicroApp）
│  ├─ 路由管理（基于 single-spa）
│  └─ 生命周期（5个钩子）
│
├─ JavaScript 隔离
│  ├─ SnapshotSandbox（快照）
│  ├─ LegacySandbox（单例 Proxy）
│  └─ ProxySandbox（多例 Proxy）
│
├─ 样式隔离
│  ├─ strictStyleIsolation（Shadow DOM）
│  └─ experimentalStyleIsolation（Scoped CSS）
│
└─ 性能优化
   ├─ 预加载（prefetch）
   ├─ 缓存策略
   ├─ 代码分割
   └─ 监控告警
```

---

## 🏆 预期收获

学习完本资料后，您将能够：

✅ **深入理解**微前端的核心原理
✅ **掌握** qiankun 的底层实现
✅ **解答**面试中的各种问题
✅ **解决**实际项目中的技术难题
✅ **设计**合理的微前端架构
✅ **优化**应用的加载性能

---

## 📞 联系与反馈

如有问题或建议，欢迎交流讨论！

祝您面试顺利，offer 多多！🎉

---

**创建时间**：2025年11月7日  
**基于版本**：qiankun 2.x, import-html-entry 1.x  
**更新状态**：✅ 全部完成（30/30）

